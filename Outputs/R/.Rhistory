Raster_sm = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
RasterBurn = Raster_fc + Raster_sm
TotBurn = TotBurn + RasterBurn
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT[Raster_FT == 1] = 0
Raster_AllT = Raster_FT
Raster_FT[Raster_FT != 0] = 1
FreqAllT = FreqAllT + Raster_FT
Raster_Acc = Raster_FT
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc == 2] = 1
FreqAcc = FreqAcc + Raster_Acc
Raster_Nat = Raster_FT
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
FreqNat = FreqNat + Raster_Nat
Raster_Rx = Raster_FT
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx == 4] = 1
FreqRx = FreqRx + Raster_Rx
if(i==100){
TotBurn[TotBurn == 0] = NA
names(TotBurn) = scenario
RasterStack_Burn = stack(RasterStack_Burn, TotBurn)
FreqAllT[FreqAllT == 0] = NA
names(FreqAllT) = paste0(scenario,"all")
RasterStack_AllF = stack(RasterStack_AllF, FreqAllT)
FreqAcc[FreqAcc == 0] = NA
names(FreqAcc) = paste0(scenario,"Acc")
RasterStack_AccF = stack(RasterStack_AccF, FreqAcc)
FreqNat[FreqNat == 0] = NA
names(Raster_Nat) = paste0(scenario,"Nat")
RasterStack_NatF = stack(RasterStack_NatF, FreqNat)
FreqRx[FreqRx == 0] = NA
names(FreqRx) = paste0(scenario,"Rx")
RasterStack_RxF = stack(RasterStack_RxF, FreqRx)
}
}
}
VarSatck = RasterStack_Burn
Max = max(maxValue(VarSatck))+1
Min = min(minValue(VarSatck))
brks = seq(Min,Max,by=0.1)
nbrks = length(brks)-1
r.range = c(Min, Max)
rasTot = raster(ncol=2, nrow=1)
values(rasTot) = c(Min,Max)
par(mfrow=c(1,3))
plot(VarSatck, breaks=brks,col=pal.2(nbrks), legend = F, zlim=c(Min,Max),
main = "Sum of biomass burned")
Zero = paste0(BAU_input, "..1/scrapple-fire/flaming-consumptions-1.img") %>% raster()
Zero[Zero != 0] = 0
RasterStack_Burn = stack()
RasterStack_AllF = stack()
RasterStack_AccF = stack()
RasterStack_NatF = stack()
RasterStack_RxF = stack()
scenario = "BAU"
if(scenario == "BAU") {
Input = BAU_input
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero
} else if(scenario == "Adapty"){
Input = Adapty_input
TotBurn = Zero
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero
} else {
Input = ProAct_input
TotBurn = Zero
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero}
i=1
Raster_fc = paste0(Input, "..1/scrapple-fire/flaming-consumptions-",i,".img") %>% raster()
Raster_sm = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
RasterBurn = Raster_fc + Raster_sm
TotBurn = TotBurn + RasterBurn
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT[Raster_FT == 1] = 0
Raster_AllT = Raster_FT
Raster_FT[Raster_FT != 0] = 1
FreqAllT = FreqAllT + Raster_FT
Raster_Acc = Raster_FT
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc == 2] = 1
FreqAcc = FreqAcc + Raster_Acc
Raster_Nat = Raster_FT
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
FreqNat = FreqNat + Raster_Nat
Raster_Rx = Raster_FT
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx == 4] = 1
FreqRx = FreqRx + Raster_Rx
i=100
Raster_fc = paste0(Input, "..1/scrapple-fire/flaming-consumptions-",i,".img") %>% raster()
Raster_sm = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
RasterBurn = Raster_fc + Raster_sm
RasterBurn = Raster_fc + Raster_sm
TotBurn = TotBurn + RasterBurn
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT[Raster_FT == 1] = 0
Raster_AllT = Raster_FT
Raster_FT[Raster_FT != 0] = 1
Raster_FT[Raster_FT != 0] = 1
FreqAllT = FreqAllT + Raster_FT
Raster_Acc = Raster_FT
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc == 2] = 1
FreqAcc = FreqAcc + Raster_Acc
Raster_Nat = Raster_FT
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
FreqNat = FreqNat + Raster_Nat
Raster_Rx = Raster_FT
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx == 4] = 1
FreqRx = FreqRx + Raster_Rx
if(i==100){
TotBurn[TotBurn == 0] = NA
names(TotBurn) = scenario
RasterStack_Burn = stack(RasterStack_Burn, TotBurn)
FreqAllT[FreqAllT == 0] = NA
names(FreqAllT) = paste0(scenario,"all")
RasterStack_AllF = stack(RasterStack_AllF, FreqAllT)
FreqAcc[FreqAcc == 0] = NA
names(FreqAcc) = paste0(scenario,"Acc")
RasterStack_AccF = stack(RasterStack_AccF, FreqAcc)
FreqNat[FreqNat == 0] = NA
names(Raster_Nat) = paste0(scenario,"Nat")
RasterStack_NatF = stack(RasterStack_NatF, FreqNat)
FreqRx[FreqRx == 0] = NA
names(FreqRx) = paste0(scenario,"Rx")
RasterStack_RxF = stack(RasterStack_RxF, FreqRx)
}
TotBurn[TotBurn == 0] = NA
names(TotBurn) = scenario
RasterStack_Burn = stack(RasterStack_Burn, TotBurn)
FreqAllT[FreqAllT == 0] = NA
names(FreqAllT) = paste0(scenario,"all")
RasterStack_AllF = stack(RasterStack_AllF, FreqAllT)
FreqAcc[FreqAcc == 0] = NA
plot(FreqAcc)
FreqAcc = FreqAcc + Raster_Acc
i=1
Raster_fc = paste0(Input, "..1/scrapple-fire/flaming-consumptions-",i,".img") %>% raster()
Raster_sm = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
RasterBurn = Raster_fc + Raster_sm
RasterBurn = Raster_fc + Raster_sm
TotBurn = TotBurn + RasterBurn
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT[Raster_FT == 1] = 0
Raster_AllT = Raster_FT
Raster_FT[Raster_FT != 0] = 1
FreqAllT = FreqAllT + Raster_FT
Raster_Acc = Raster_FT
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc == 2] = 1
Raster_Acc[Raster_Acc == 2] = 1
FreqAcc = FreqAcc + Raster_Acc
Raster_Nat = Raster_FT
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
FreqNat = FreqNat + Raster_Nat
FreqNat = FreqNat + Raster_Nat
Raster_Rx = Raster_FT
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx == 4] = 1
plot(FreqAcc)
Zero = paste0(BAU_input, "..1/scrapple-fire/flaming-consumptions-1.img") %>% raster()
Zero[Zero != 0] = 0
Zero[Zero != 0] = 0
RasterStack_Burn = stack()
RasterStack_AllF = stack()
RasterStack_AllF = stack()
RasterStack_AccF = stack()
RasterStack_NatF = stack()
RasterStack_NatF = stack()
RasterStack_RxF = stack()
if(scenario == "BAU") {
Input = BAU_input
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero
} else if(scenario == "Adapty"){
Input = Adapty_input
TotBurn = Zero
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero
} else {
Input = ProAct_input
TotBurn = Zero
TotBurn = Zero
FreqAllT = Zero
FreqAcc = Zero
FreqNat = Zero
FreqRx = Zero}
i=100
Raster_fc = paste0(Input, "..1/scrapple-fire/flaming-consumptions-",i,".img") %>% raster()
Raster_sm = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
RasterBurn = Raster_fc + Raster_sm
RasterBurn = Raster_fc + Raster_sm
TotBurn = TotBurn + RasterBurn
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT = paste0(Input, "..1/scrapple-fire/ignition-type-",i,".img") %>% raster()
Raster_FT[Raster_FT == 1] = 0
Raster_AllT = Raster_FT
Raster_FT[Raster_FT != 0] = 1
FreqAllT = FreqAllT + Raster_FT
Raster_Acc = Raster_FT
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc != 2] = 0
Raster_Acc[Raster_Acc == 2] = 1
FreqAcc = FreqAcc + Raster_Acc
Raster_Nat = Raster_FT
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
Raster_Nat[Raster_Nat != 3] = 0
Raster_Nat[Raster_Nat == 3] = 1
FreqNat = FreqNat + Raster_Nat
Raster_Rx = Raster_FT
Raster_Rx = Raster_FT
Raster_Rx[Raster_Rx != 4] = 0
Raster_Rx[Raster_Rx == 4] = 1
FreqRx = FreqRx + Raster_Rx
if(i==100){
#TotBurn[TotBurn == 0] = NA
names(TotBurn) = scenario
RasterStack_Burn = stack(RasterStack_Burn, TotBurn)
#FreqAllT[FreqAllT == 0] = NA
names(FreqAllT) = paste0(scenario,"all")
RasterStack_AllF = stack(RasterStack_AllF, FreqAllT)
#FreqAcc[FreqAcc == 0] = NA
names(FreqAcc) = paste0(scenario,"Acc")
RasterStack_AccF = stack(RasterStack_AccF, FreqAcc)
#FreqNat[FreqNat == 0] = NA
names(Raster_Nat) = paste0(scenario,"Nat")
RasterStack_NatF = stack(RasterStack_NatF, FreqNat)
#FreqRx[FreqRx == 0] = NA
names(FreqRx) = paste0(scenario,"Rx")
RasterStack_RxF = stack(RasterStack_RxF, FreqRx)
}
MorTable$mean_mortality = MorTable$mean_mortality %>% as.numeric()
MorTable$sd = MorTable$sd %>% as.numeric()
wd = "C:/Users/181248/Documents/Klamath_(CA_only)_2021 - Harvest Pro-active/"
setwd(wd)
wd = "C:/Users/181248/Documents/Klamath_(CA_only)_2021 - Harvest Pro-active/"
library(raster)
library(rgdal)
library(devtools)
library(magrittr)
library(sf)
library(nngeo)
Input = "C:/Users/181248/Documents/Klamath_(CA_only)_2021 - Harvest Pro-active/"
library(raster)
library(rgdal)
library(devtools)
library(magrittr)
library(sf)
library(nngeo)
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(Stack,BMremoved)
}
i=5
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
Input = "D:/Users/181248/Documents/Klamath_(CA_only)_2021 - Harvest Pro-active/"
library(raster)
library(rgdal)
library(devtools)
library(magrittr)
library(sf)
library(nngeo)
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(Stack,BMremoved)
}
StackBM = stack()
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(Stack,BMremoved)
}
BMR_Tot = sum(StackBMR)
plot(BMR_Tot)
plot(StackBMR)
StackBMR = stack()
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(Stack,BMremoved)
}
BMR_Tot = sum(StackBMR)
plot(StackBMR)
StackBMR = stack()
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(StackBMR,BMremoved)
}
BMR_Tot = sum(StackBMR)
plot(StackBMR)
plot(BMR_Tot)
ListInsect =list.files(paste0(Input, "..1/bda/"),pattern = ".img$")
ListInsect =list.files(paste0(Input, "..1/bda/"),pattern = ".img$",full.names = T)
StackBMR = stack()
for (i in seq(5,100,by = 5)) {
BMremoved = paste0(Input, "..1/harvest/biomass-removed-",i,".tif") %>% raster()
StackBMR = stack(StackBMR,BMremoved)
}
BMR_Tot = sum(StackBMR)
StackBMB = stack()
for (i in 1:100) {
BMconsumed1 = paste0(Input, "..1/scrapple-fire/flaming-consumptions-",i,".img") %>% raster()
BMconsumed2 = paste0(Input, "..1/scrapple-fire/smolder-consumption-",i,".img") %>% raster()
BMburned = BMconsumed1 + BMconsumed2
StackBMB = stack(StackBMB,BMburned)
}
BMB_Tot = sum(StackBMB)
StackBMI = stack()
ListInsect =list.files(paste0(Input, "..1/bda/"),pattern = ".img$",full.names = T)
for (i in length(ListInsect)) {
BMinsect = ListInsect[i] %>% raster()
StackBMI = stack(StackBMI,BMinsect)
}
BMI_Tot = sum(StackBMI)
plot(StackBMI)
Input = "D:/Users/181248/Documents/Klamath_(CA_only)_2021 - Harvest Pro-active/"
library(raster)
library(rgdal)
library(devtools)
library(magrittr)
library(sf)
library(nngeo)
pal.2 = colorRampPalette(c("purple","yellow"))
VarSatck = Stack(BMR_Tot,BMB_Tot)
VarSatck = stack(BMR_Tot,BMB_Tot)
Max = max(maxValue(VarSatck))+1
Min = min(minValue(VarSatck))
brks = seq(Min,Max,by=0.1)
nbrks = length(brks)-1
r.range = c(Min, Max)
rasTot = raster(ncol=2, nrow=1)
values(rasTot) = c(Min,Max)
par(mfrow=c(1,2))
plot(VarSatck, breaks=brks,col=pal.2(nbrks), legend = F, zlim=c(Min,Max),
main = "Biomass Removed")
VarSatck = stack(BMR_Tot,BMB_Tot)
Max = max(maxValue(VarSatck))+1
Min = min(minValue(VarSatck))
brks = seq(Min,Max,by=10000)
nbrks = length(brks)-1
r.range = c(Min, Max)
rasTot = raster(ncol=2, nrow=1)
values(rasTot) = c(Min,Max)
par(mfrow=c(1,2))
plot(VarSatck, breaks=brks,col=pal.2(nbrks), legend = F, zlim=c(Min,Max),
main = "Biomass Removed")
plot(rasTot, legend.only=TRUE, col=pal.2(nbrks),
legend.width=1, legend.shrink=0.75,
legend.args=list(text="??",
side=4, font=2, line=2.5, cex=0.8))
BMR_Tot[BMR_Tot == 0] = NA
BMB_Tot[BMB_Tot == 0] = NA
VarSatck = stack(BMR_Tot,BMB_Tot)
Max = max(maxValue(VarSatck))+1
Min = min(minValue(VarSatck))
brks = seq(Min,Max,by=10000)
nbrks = length(brks)-1
r.range = c(Min, Max)
rasTot = raster(ncol=2, nrow=1)
values(rasTot) = c(Min,Max)
par(mfrow=c(1,2))
plot(VarSatck, breaks=brks,col=pal.2(nbrks), legend = F, zlim=c(Min,Max),
main = "Biomass Removed")
plot(rasTot, legend.only=TRUE, col=pal.2(nbrks),
legend.width=1, legend.shrink=0.75,
legend.args=list(text="??",
side=4, font=2, line=2.5, cex=0.8))
Resistence = paste0(Input, "..1/Ownership_CA_Refugias.tif")
Resistence[Resistence != 11] = NA
Resistence = rasterToPolygons(Resistence, fun=function(x){x > 0}, dissolve = T)
plot(Resistence)
Resistence = paste0(Input, "..1/Ownership_CA_Refugias.tif")
plot(Resistence)
Resistence = paste0(Input, "..1/Ownership_CA_Refugias.tif") %>% raster()
Resistence[Resistence != 11] = NA
Restist_Area = Resistence %>% st_as_sf %>%
st_union %>% st_remove_holes %>% st_as_sf
Resistence = rasterToPolygons(Resistence, fun=function(x){x > 0}, dissolve = T)
plot(Resistence)
Restist_Area = Resistence %>% st_as_sf %>%
st_union  %>% st_as_sf
plot(Restist_Area, main = "Figure 1: Borders of the study area")
BMR = mask(BMR_Tot, Restist_Area)
BMR = mask(BMR_Tot, Restist_Area)
BMB = mask(BMB_Tot, Restist_Area)
VarSatck = stack(BMR,BMB_Tot)
Max = max(maxValue(VarSatck))+1
Min = min(minValue(VarSatck))
brks = seq(Min,Max,by=10000)
plot(BMR)
setwd(
"D:/Users/181248/Documents/R")
library(raster)
library(rgdal)
library(devtools)
library(sf)
library(nngeo)
library(ggplot2)
library(ggrepel)
library(cowplot)
#install_github("jeffreyevans/spatialEco")
library(spatialEco)
library(magrittr)
library(svMisc)
title = ggdraw() +
draw_label(
"Figure X",
fontface = 'plain', x = 0, hjust = 0, size = 14) +
theme(plot.margin = margin(0, 0, 0, 50))
Points = ggplot(ResultTree, aes(x=Migration_x, y=Migration_y, col=Distribution, shape = Distribution)) +
geom_point() +
scale_x_continuous(name= "") +
scale_y_continuous(name = "North-South Migration") +
ggtitle("Centroid difference of position by species after 100 years (BAU vs adaptability)") +
theme(plot.title = element_text(hjust = 0.5)) +
facet_wrap(~Scenario)
ggplot(Event_Ag2, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))+
facet_wrap(~Scenario, nrow = 2)
Event_Tot = c("Year", "Day", "FWI", "Scenario")
Event = paste0(BAU_input,"..1/scrapple-events-log.csv") %>% read.csv()
EventFWI = cbind(Event$SimulationYear, Event$InitialDayOfYear, Event$MeanFWI) %>% as.data.frame()
EventFWI$Scenario = scenario
Event_Tot = rbind(Event_Tot, EventFWI)
Event_Tot = as.data.frame(Event_Tot)
colnames(Event_Tot)=Event_Tot[1,] %>% unlist %>% as.character
Event_Tot=Event_Tot[-1,]
j=c(1:3)
Event_Tot[ , j] = apply(Event_Tot[ , j], 2,
function(x) as.numeric(as.character(x)))
Event_Ag = aggregate(data=Event_Tot, FWI~Year, mean)
ggplot(Event_Ag, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))+
facet_wrap(~Scenario, nrow = 2)
ggplot(Event_Ag, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))
Event_Tot2 = c("Year", "Day", "FWI", "Scenario")
Event2 = paste0(BAU_input,"..Clim2/scrapple-events-log.csv") %>% read.csv()
EventFWI2 = cbind(Event2$SimulationYear, Even2t$InitialDayOfYear, Event2$MeanFWI) %>% as.data.frame()
EventFWI2$Scenario = scenario
Event_Tot2 = rbind(Event_Tot2, EventFWI2)
Event_Tot2 = c("Year", "Day", "FWI", "Scenario")
Event2 = paste0(BAU_input,"..Clim2/scrapple-events-log.csv") %>% read.csv()
EventFWI2 = cbind(Event2$SimulationYear, Event2$InitialDayOfYear, Event2$MeanFWI) %>% as.data.frame()
EventFWI2$Scenario = scenario
Event_Tot2 = rbind(Event_Tot2, EventFWI2)
Event_Tot2 = as.data.frame(Event_Tot2)
colnames(Event_Tot2)=Event_Tot2[1,] %>% unlist %>% as.character
Event_Tot2=Event_Tot2[-1,]
j=c(1:3)
Event_Tot2[ , j] = apply(Event_Tot2[ , j], 2,
function(x) as.numeric(as.character(x)))
Event_Ag2 = aggregate(data=Event_Tot2, FWI~Year, mean)
ggplot(Event_Ag2, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))+
ggplot(Event_Ag2, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))
ggplot(Event_Ag2, aes(x=Year, y=FWI)) +
geom_line() +
xlab("year")+
ylab("Mean fire weather index")+
ggtitle("Mean Fire Weather Index for all the events") +
theme(plot.title = element_text(hjust = 0.5))
